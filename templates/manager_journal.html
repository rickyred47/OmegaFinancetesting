{% extends "base_manager.html" %}
    {% block title %}Journal{% endblock %}
    {% block head %}
        <link href="{{ url_for('static', filename= 'files/journal/journalstyle.css') }}" type="text/css" rel="stylesheet"/>
        <script src="{{ url_for('static', filename= 'files/journal/journaldata.js') }}"></script>
    {% endblock %}
    {% block content %}
    <!--White ground box -->
    <div id="background_bx">
		<div id="journal_lbl">
			<p>Journal</p>
		</div>

		<div id="add_btn">
			<input id="add_btn_input" type="button" value="+Add" onclick="show_journal_entry()">
		</div>
		<div id="journal_entry" style="padding:20px">
		<form action="{{ url_for('accountant_journal_submit') }}" method="post">
        <input id="debit_accounts_counter" type="text" value="0" style="display: none" name="debit_accounts_counter">
        <input id="credit_accounts_counter" type="text" value="0" style="display: none" name="credit_accounts_counter">
			<table id="journal_table_entry">
				<tr>
					<th style="width: 400px">Journal Entry</th>
					<th style="width: 500px">Accounts</th>
					<th style="width: 250px">Debit</th>
					<th style="width: 250px">Credit</th>
				</tr>
				<tr>
					<td>
                        <br>
						<div style="padding-left:10px">
							<p><span>Date: </span><span><input id="journal_date" type="date" name="date_entry"></span></p>
							<br>
							<select id="journal_type" name="journal_type" style="width: 400px">
								<option value="Regular">Regular</option>
								<option value="Adjusting">Adjusting</option>
								<option value="Reversing">Reversing</option>
								<option value="Closing">Closing</option>
							</select>
							<br><br>
							<textarea id="description" rows="5" cols="50" placeholder="Description here ..." name="description"></textarea>
							<p>Choose a file to upload:</p>
  								<label for="file">Select a file:</label>
  								<input type="file" id="file_btn" name="file">
						</div>
					</td>
                <!-- Accounts selection -->
					<td id="accounts_column">
						<div id="debit_accounts_div0" style="padding-left:10px">
							<select id="debit_account_select0" class="debit_select_accounts" name="debit_account_select0">
                                <option value="">--Accounts--</option>
                                {% for account in accounts %}
                                <option value="{{ account.name }}">{{ account.name }}</option>
                                {% endfor %}
                            </select>
							<input id="debit_plus_btn" class="plus_minus_btns" type="button" value="+" onclick="add_account_input('debit')"><input id="debit_minus_btn0" class="plus_minus_btns" type="button" value="-" onclick="delete_account_input('debit', this.id)">
                        </div>
                        <br id="break">
						<div id="credit_accounts_div0" style="padding-left:50px">
							<select id="credit_account_select0" class="credit_select_accounts" name="credit_account_select0">
                                <option value="">--Accounts--</option>
                                {% for account in accounts %}
                                <option value="{{ account.name }}">{{ account.name }}</option>
                                {% endfor %}
                            </select>
							<input id="credit_plus_btn" class="plus_minus_btns" type="button" value="+" onclick="add_account_input('credit')"><input id="credit_minus_btn0" class="plus_minus_btns" type="button" value="-" onclick="delete_account_input('credit', this.id)">
						</div>
					</td>
					<td id="debit_amount_column">
						<div id="debit_amount0" style="padding-left:10px">
							<label>&#36; </label><input id="debit_amount_input0" class="input_amounts" type="number" placeholder="0.00" name="debit_amount_input0" style="width: 150px">
						</div>
					</td>
					<td id="credit_amount_column" style="padding-top:55px">
						<div id="credit_amount0" style="padding-left:30px">
							<label>&#36; </label><input id="credit_amount_input0" class="input_amounts" type="number" placeholder="0.00" name="credit_amount_input0" style="width: 150px">
						</div>
					</td>
				</tr>
			</table>
			<div id="buttons">
                <input id="close" type="button" value="Close" onclick="close_journal_entry()">
			    <input id="clear" type="reset" value="Clear">
			    <input id="submit" type="submit" value="Submit">
			</div>
			</form>
		</div>

		<div id="search_bx">
			<input type="text" placeholder="Journal Search">
		</div>
        <br><br>
        <div class="flex_container">
		<div id="date_range">
			<p>Filter: Date Range</p>
			<p><input type="date"> to <input type="date"></p>
		</div>
		<div id="status">
			<p>Filter: Status</p>
			<p>
				<select id="select_status" name="select_status" style="width:200px">
					<option value="All">All</option>
					<option value="Pending">Pending</option>
					<option value="Apporved">Approved</option>
					<option value="Rejected">Rejected</option>
				</select>
			</p>
		</div>
        </div>
        <br>
		<table id="journal_table">
			<tr>
				<th style="width:175px">Date</th>
				<th style="width:175px">Type</th>
				<th style="width:45px">PR</th>
				<th style="width:150px">Created By</th>
				<th style="width:400px">Accounts</th>
				<th style="width:200px">Debit</th>
				<th style="width:200px">Credit</th>
				<th style="width:145px">Status</th>
			</tr>
            {% for entry in entries %}
            <tr class="entries_info">
                <td>{{ entry.date }}</td>
                <td>{{ entry.type }}</td>
                <td>{{ entry.id }}</td>
                <td>{{ entry.created_by }}</td>
                <td colspan="3">
                    <table id="inner_table">
                        <tr id="debit_info">
                            <td style="width: 400px; font-weight: bold">
                                {% for debit_account in entry.debit_accounts %}
                                    <p>{{ debit_account }}</p>
                                {% endfor %}
                            </td>
                            <td style="width: 200px; text-align: right">
                                {% for debit_amounts in entry.debit_amounts %}
                                    <p>{{ "${:,.2f}".format(debit_amounts) }}</p>
                                {% endfor %}
                            </td>
                            <td style="width: 190px"></td>
                        </tr>
                        <tr id="credit_info">
                            <td style="font-weight: bold">
                                {% for credit_account in entry.credit_accounts %}
                                   <p style="margin-left: 30px">{{ credit_account }}</p>
                                {% endfor %}
                            </td>
                            <td></td>
                            <td style="margin-left: 30px; text-align: right">
                                {% for credit_amount in entry.credit_amounts %}
                                    <p>{{ "${:,.2f}".format(credit_amount) }}</p>
                                {% endfor %}
                            </td>
                        </tr>
                        <tr>
                            <td style="font-size: 14px"><span style="font-weight: bold;">Description: </span>{{ entry.description }}</td>
                            <td></td>
                            <td></td>
                        </tr>
                    </table>
                </td>
                <td>{{ entry.status }}</td>
            </tr>
            {% endfor %}
		</table>
	</div>
        <script>
        const now = new Date();
let now_day = now.getDate();
let now_month = now.getMonth();
now_month = now_month + 1;
let year = now.getFullYear();
let date;
if (now_month < 10) {
    if(now_day < 10) {
        date = "" + year + "-0" + now_month + "-0" + now_day;
    } else {
        date = "" + year + "-0" + now_month + "-" + now_day;
    }
}
else {
    if(now_day < 10){
        date = "" + year + "-" + now_month + "-0" + now_day;
    } else {
        date = "" + year + "-" + now_month + "-" + now_day;
    }
}
document.getElementById("journal_date").min = date;
document.getElementById("journal_date").value = date;
        </script>
    {% endblock %}
